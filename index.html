<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Оракул</title>
<style>
body {
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', sans-serif;
  height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  background-image: url('background.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

header {
  position: fixed;
  top: 20px;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 1000;
}

header .logo {
  height: 40px;
  width: auto;
  object-fit: contain;
  margin-bottom: 5px;
}

header .name {
  height: 30px;
  width: auto;
  object-fit: contain;
}

#buildNumber {
  color: white;
  text-shadow: 1px 1px 2px black;
  margin: 5px 0;
  font-size: 14px;
}

.icons {
  display: grid;
  grid-template-columns: repeat(2, 120px);
  grid-gap: 20px;
  place-items: center;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

.icons img {
  width: 100px;
  height: 100px;
  object-fit: contain;
  cursor: pointer;
  transition: transform 0.3s;
}

.icons img:hover {
  transform: scale(1.1);
}

.screen {
  display: none;
  flex: 1;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.cookie-image, .sphere-image {
  width: 180px;
  max-width: 300px;
  transition: transform 0.5s ease;
  margin-bottom: 20px;
  cursor: pointer;
}

.cookie-image.opened {
  transform: scale(2) rotate(-5deg);
}

.fortune, .sphere-text, .tarot-text {
  font-size: 18px;
  font-weight: bold;
  color: #fff !important;
  max-width: 90%;
  margin-bottom: 20px;
  padding: 10px;
  text-align: center;
  text-shadow: 0 2px 8px rgba(0,0,0,0.8);
  background-color: rgba(0,0,0,0.5);
  border-radius: 10px;
  max-height: 200px;
  overflow-y: auto;
  opacity: 0;
  transition: opacity 0.8s ease;
}

.fortune.show, .sphere-text.show, .tarot-text.show {
  opacity: 1;
}

#reloadButton {
  display: none;
  background-color: transparent;
  border: none;
  padding: 0;
  margin-top: 10px;
}

#reloadButton img {
  width: 50px;
  height: 50px;
  object-fit: contain;
  cursor: pointer;
}

#backButton {
  position: fixed;
  top: 15px;
  left: 15px;
  width: 40px;
  height: 40px;
  background: none;
  border: none;
  padding: 0;
  display: none;
  z-index: 2000;
}

#backButton img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  cursor: pointer;
}

/* Таро */
.tarot-cards {
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
  margin-bottom: 20px;
}

.tarot-card-container {
  width: 120px;
  height: 180px;
  cursor: pointer;
  flex-shrink: 0;
  position: relative;
}

.tarot-card-container img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

@media (max-width: 350px) {
  .cookie-image, .sphere-image, .tarot-card-container {
    width: 100px;
    height: 150px;
  }
}
</style>
</head>
<body>

<header>
  <img src="logo.png" alt="Логотип" class="logo">
  <img src="name.png" alt="Название" class="name">
  <p id="buildNumber">Сборка 7</p>
</header>

<!-- Главный экран -->
<div class="icons" id="mainScreen">
  <img src="sphere.png" alt="Шар" onclick="showSphereScreen()">
  <img src="cookie.png" alt="Печенье" onclick="showCookieScreen()">
  <img src="tarot.png" alt="Таро" onclick="showTarotScreen()">
  <img src="zodiac.png" alt="Зодиак">
</div>

<!-- Экран печенья -->
<div class="screen" id="cookieScreen">
  <img id="cookieImage" class="cookie-image" src="cookie_closed.png" alt="Печенье" onclick="openCookie()">
  <div class="fortune" id="fortune"></div>
  <button id="reloadButton" onclick="reloadCookie()">
    <img src="reload.png" alt="Перезагрузить">
  </button>
</div>

<!-- Экран сферы -->
<div class="screen" id="sphereScreen">
  <img src="sphere.png" alt="Сфера" class="sphere-image">
  <div class="sphere-text" id="sphereText"></div>
</div>

<!-- Экран Таро -->
<div class="screen" id="tarotScreen">
  <div class="tarot-cards">
    <div class="tarot-card-container" onclick="openTarotCard(this, 1)">
      <img src="close.png" alt="Рубашка" class="card-img">
    </div>
    <div class="tarot-card-container" onclick="openTarotCard(this, 2)">
      <img src="close.png" alt="Рубашка" class="card-img">
    </div>
    <div class="tarot-card-container" onclick="openTarotCard(this, 3)">
      <img src="close.png" alt="Рубашка" class="card-img">
    </div>
  </div>
  <div class="tarot-text" id="tarotText"></div>
</div>

<!-- Кнопка назад -->
<button id="backButton" onclick="goBack()">
  <img src="back.png" alt="Назад">
</button>

<script>
let predictions = [];
let spherePredictions = [];
let tarotPredictions = [];

// Загрузка JSON
fetch('predictions.json').then(res=>res.json()).then(data=>predictions=data).catch(err=>console.error(err));
fetch('sphere_predictions.json').then(res=>res.json()).then(data=>spherePredictions=data).catch(err=>console.error(err));
fetch('tarot_predictions.json').then(res=>res.json()).then(data=>tarotPredictions=data).catch(err=>console.error(err));

const mainScreen = document.getElementById("mainScreen");
const cookieScreen = document.getElementById("cookieScreen");
const sphereScreen = document.getElementById("sphereScreen");
const tarotScreen = document.getElementById("tarotScreen");
const cookieImg = document.getElementById("cookieImage");
const fortune = document.getElementById("fortune");
const reloadBtn = document.getElementById("reloadButton");
const backBtn = document.getElementById("backButton");
const sphereText = document.getElementById("sphereText");
const tarotText = document.getElementById("tarotText");

// Печенье
function showCookieScreen() { mainScreen.style.display="none"; cookieScreen.style.display="flex"; backBtn.style.display="block";}
function openCookie() {
  if(!cookieImg.classList.contains("opened")){
    cookieImg.src="cookie_open.png";
    cookieImg.classList.add("opened");
    fortune.textContent = predictions.length ? predictions[Math.floor(Math.random()*predictions.length)] : "Предсказание недоступно";
    fortune.classList.add("show");
    reloadBtn.style.display="inline-block";
  }
}
function reloadCookie() { cookieImg.src="cookie_closed.png"; cookieImg.classList.remove("opened"); fortune.classList.remove("show"); fortune.textContent=""; reloadBtn.style.display="none";}

// Сфера
function showSphereScreen(){ mainScreen.style.display="none"; sphereScreen.style.display="flex"; backBtn.style.display="block"; sphereText.textContent=''; sphereText.classList.remove("show"); }

// Таро
function showTarotScreen(){ mainScreen.style.display="none"; tarotScreen.style.display="flex"; backBtn.style.display="block"; tarotText.textContent=''; tarotText.classList.remove("show"); 
  const cards = document.querySelectorAll(".tarot-card-container img");
  cards.forEach(card => card.src="close.png");
}

// Кнопка назад
function goBack(){ cookieScreen.style.display="none"; sphereScreen.style.display="none"; tarotScreen.style.display="none"; backBtn.style.display="none"; mainScreen.style.display="grid"; reloadCookie();}

// Открытие карты Таро
function openTarotCard(container, num){
  const cardImg = container.querySelector("img");
  if(cardImg.src.includes("close.png")){
    cardImg.src = `open${num}.png`;
    tarotText.textContent = tarotPredictions.length ? tarotPredictions[Math.floor(Math.random()*tarotPredictions.length)] : "Толкование недоступно";
    tarotText.classList.add("show");
  }
}

// Тряска для сферы
let lastTime=new Date();
window.addEventListener('devicemotion', event=>{
  if(sphereScreen.style.display!=='flex') return;
  const acc=event.accelerationIncludingGravity;
  const now=new Date();
  if(now-lastTime>500){
    lastTime=now;
    const speed=Math.abs(acc.x)+Math.abs(acc.y)+Math.abs(acc.z);
    if(speed>25){
      if(spherePredictions.length) { sphereText.textContent = spherePredictions[Math.floor(Math.random()*spherePredictions.length)]; }
      else { sphereText.textContent="Предсказание недоступно"; }
      sphereText.classList.add("show");
    }
  }
});
</script>
</body>
</html>
